Логика обнаружения конца данных:     

Если получено меньше записей чем batch_size (и больше 0) - это последняя страница

Если получено ровно batch_size - продолжаем получать следующую страницу     

Если получено 0 записей, проверяем несколько страниц подряд (max_consecutive_empty = 3)     

Обработка ошибок:          

Разные типы исключений обрабатываются по-разному       

более подробное логирование        

защиата от бесконечного цикла:              

Счетчик подряд идущих пустых страниц                       

Таймауты и обработка ошибок соединения                       

отчетность:             

Разделила домены без заявок и домены с ошибками                  

Добавила скорость обработки для каждого домена                                          

Более подробная статистика# Domen_size
